)]}'
{"version":3,"file":"/packages/gadicohen:famous-views.js","sources":["gadicohen:famous-views/lib/famous-views.js","gadicohen:famous-views/lib/meteorFamousView.js","gadicohen:famous-views/lib/sequencer.js","gadicohen:famous-views/lib/famous.js","gadicohen:famous-views/lib/famousEach.js","gadicohen:famous-views/lib/modifiers.js","gadicohen:famous-views/lib/views.js","gadicohen:famous-views/lib/views/_simple.js","gadicohen:famous-views/lib/views/ContainerSurface.js","gadicohen:famous-views/lib/views/EdgeSwapper.js","gadicohen:famous-views/lib/views/Flipper.js","gadicohen:famous-views/lib/views/HeaderFooterLayout.js","gadicohen:famous-views/lib/views/RenderController.js","gadicohen:famous-views/lib/views/Scrollview.js","gadicohen:famous-views/lib/views/Surface.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,mB;;AAEA,0C;AACA,uD;;AAEA,iC;AACA,0D;;AAEA,uB;;AAEA,oB;AACA,mC;AACA,8B;AACA,Y;AACA,sB;AACA,a;AACA,U;AACA,0B;AACA,U;AACA,oB;AACA,uB;AACA,E;AACA,C;AACA,+B;AACA,sB;AACA,oB;AACA,2B;AACA,yB;AACA,E;AACA,C;;AAEA,mC;AACA,iB;;AAEA,qE;AACA,0B;AACA,mB;AACA,G;;AAEA,4B;AACA,mE;AACA,0E;AACA,yB;;AAEA,mB;AACA,qB;AACA,oC;;AAEA,4C;AACA,qB;;AAEA,2B;AACA,6B;;AAEA,gE;AACA,mB;AACA,iC;AACA,yB;AACA,yB;AACA,qB;AACA,wE;AACA,sD;AACA,yD;;AAEA,sB;AACA,8B;AACA,U;AACA,kC;AACA,sE;AACA,gF;AACA,oC;AACA,mE;AACA,K;;AAEA,4B;AACA,uD;AACA,K;AACA,E;;AAEA,sB;;AAEA,yB;AACA,E;AACA,iC;AACA,mB;AACA,+C;AACA,yC;AACA,mB;AACA,kD;AACA,E;;AAEA,6C;AACA,qC;AACA,+E;AACA,kB;AACA,C;AACA,I;AACA,6B;AACA,yC;AACA,6E;AACA,qB;AACA,Y;AACA,2G;AACA,K;AACA,K;;AAEA,iC;AACA,4B;AACA,qB;AACA,uB;AACA,gB;AACA,wB;AACA,mB;AACA,sB;AACA,gB;;AAEA,6C;AACA,Y;AACA,mD;AACA,6D;AACA,iE;AACA,oE;;AAEA,S;AACA,+B;AACA,K;AACA,iB;AACA,4D;AACA,qB;AACA,uB;AACA,K;;AAEA,wB;AACA,uC;AACA,6B;AACA,e;AACA,U;AACA,mC;AACA,wB;AACA,mB;AACA,kB;AACA,G;;AAEA,I;AACA,4B;AACA,qB;AACA,uB;AACA,gB;AACA,wB;AACA,iB;AACA,kC;AACA,iB;AACA,0D;AACA,yC;AACA,+C;AACA,e;AACA,G;AACA,iC;AACA,8B;AACA,I;AACA,C;;AAEA,gC;AACA,e;AACA,yB;AACA,0B;AACA,0B;AACA,yC;AACA,Q;AACA,2B;AACA,G;AACA,iB;AACA,C;;AAEA,8B;;AAEA,0C;AACA,4C;AACA,iB;AACA,4C;AACA,a;AACA,C;AACA,+C;AACA,oB;AACA,uB;AACA,qD;AACA,a;AACA,C;AACA,6B;AACA,8C;AACA,C;;AAEA,S;;;;;;;;;;;;;;;;;;;;;AChMA,E;AACA,yE;AACA,qE;AACA,wE;AACA,6C;AACA,G;AACA,+E;AACA,G;;AAEA,2B;AACA,+B;;AAEA,wD;AACA,mD;AACA,oC;;AAEA,6B;AACA,qB;AACA,Y;AACA,W;AACA,E;AACA,yB;AACA,sD;AACA,2D;;AAEA,uB;;AAEA,I;AACA,gB;AACA,uB;AACA,+B;AACA,K;AACA,G;AACA,I;;AAEA,+C;AACA,+B;;AAEA,uC;AACA,oE;AACA,gD;AACA,4B;AACA,uE;AACA,yC;AACA,oF;AACA,oF;AACA,yB;AACA,M;AACA,2C;AACA,0B;AACA,C;;AAEA,gD;AACA,uB;AACA,c;AACA,gB;AACA,8B;AACA,mD;AACA,Y;AACA,C;;AAEA,qD;AACA,6B;AACA,+C;AACA,mB;AACA,C;;AAEA,wD;AACA,+B;AACA,C;;AAEA,iD;AACA,sE;;AAEA,+C;AACA,gC;;AAEA,0B;AACA,mB;AACA,mB;AACA,uB;AACA,qC;AACA,C;;AAEA,uD;AACA,sB;AACA,W;;AAEA,yC;AACA,6B;;AAEA,gC;AACA,kC;AACA,8B;AACA,e;AACA,K;AACA,C;;AAEA,iD;AACA,sE;AACA,C;;AAEA,yC;AACA,+B;AACA,0B;AACA,6E;AACA,uC;AACA,C;;AAEA,sC;AACA,0C;AACA,8C;AACA,2D;AACA,6C;AACA,uE;AACA,4C;AACA,Q;AACA,0E;AACA,+C;AACA,G;AACA,C;;AAEA,2D;AACA,gD;AACA,yC;AACA,C;;AAEA,qE;AACA,6C;AACA,C;;AAEA,0D;AACA,+B;AACA,iC;AACA,C;;AAEA,2B;AACA,+B;AACA,C;;AAEA,8B;AACA,4C;AACA,2C;;AAEA,+C;AACA,sG;AACA,wC;AACA,C;;;;;;;;;;;;;;;;;;;ACnJA,iC;;AAEA,wB;AACA,qB;AACA,qB;AACA,C;;AAEA,wC;AACA,sC;AACA,4B;AACA,e;AACA,C;;AAEA,qD;AACA,yB;AACA,0C;AACA,6C;AACA,uB;AACA,C;;AAEA,gD;AACA,gF;AACA,oE;AACA,yC;AACA,G;AACA,mC;AACA,C;;AAEA,4E;AACA,+C;AACA,mC;AACA,+D;;AAEA,kE;AACA,+C;;AAEA,uD;AACA,uE;AACA,4E;AACA,C;;;;;;;;;;;;;;;;;;ACvCA,0D;AACA,uD;AACA,sB;AACA,kE;AACA,4C;AACA,E;;AAEA,uC;AACA,mC;AACA,2D;AACA,+B;AACA,6D;AACA,iC;AACA,kD;AACA,W;AACA,O;AACA,O;AACA,G;AACA,C;;AAEA,iC;AACA,gC;AACA,uF;AACA,qC;AACA,yB;AACA,yC;AACA,mD;AACA,Y;AACA,wC;AACA,K;AACA,U;AACA,kC;AACA,6B;AACA,W;AACA,G;AACA,C;;AAEA,wE;AACA,6C;AACA,2D;;AAEA,e;AACA,0B;AACA,M;AACA,4B;AACA,yB;;AAEA,I;AACA,oB;AACA,iC;AACA,I;;AAEA,qC;;AAEA,kD;AACA,0C;;AAEA,e;AACA,iB;;AAEA,uD;AACA,+D;AACA,uE;AACA,wB;AACA,8D;AACA,mF;AACA,sB;AACA,8D;AACA,6E;;AAEA,iC;AACA,qC;;AAEA,+B;AACA,6C;;AAEA,M;AACA,4D;AACA,oB;AACA,4C;AACA,mC;AACA,8B;AACA,kC;AACA,oC;AACA,U;AACA,mD;AACA,K;AACA,M;;AAEA,qD;AACA,uB;AACA,mD;AACA,8C;;AAEA,iB;AACA,6B;AACA,K;AACA,C;;AAEA,yB;AACA,sC;AACA,wE;AACA,qC;AACA,wB;AACA,C;AACA,0C;AACA,yD;AACA,qC;AACA,wB;AACA,C;;AAEA,6C;AACA,8D;AACA,sC;AACA,oE;AACA,uD;AACA,wE;AACA,oD;AACA,oE;AACA,6C;AACA,wD;AACA,sC;AACA,+C;AACA,O;AACA,O;AACA,G;AACA,C;;AAEA,0B;AACA,4B;AACA,sE;;AAEA,8B;AACA,kC;AACA,yD;AACA,yD;AACA,U;;AAEA,c;AACA,+C;AACA,wC;AACA,uD;AACA,6B;AACA,oC;AACA,oD;AACA,G;;AAEA,0B;AACA,wF;AACA,6F;AACA,kD;;AAEA,0C;AACA,yC;;AAEA,yE;AACA,0B;AACA,kD;AACA,4C;AACA,6C;AACA,0B;AACA,uB;AACA,yD;AACA,6B;AACA,G;AACA,gF;;AAEA,gH;AACA,yC;;AAEA,yE;AACA,wE;;AAEA,uD;AACA,0D;AACA,4D;AACA,yB;AACA,qD;AACA,sC;AACA,8B;AACA,4B;AACA,U;AACA,kC;AACA,W;;AAEA,I;AACA,uC;AACA,0D;AACA,qD;AACA,wE;AACA,yC;AACA,sC;AACA,gD;AACA,Y;AACA,yB;AACA,K;AACA,2C;AACA,G;AACA,I;;AAEA,iB;;AAEA,0C;;AAEA,yC;AACA,6B;;AAEA,4B;AACA,wC;AACA,kD;AACA,K;;AAEA,G;;AAEA,2B;;AAEA,0D;AACA,iE;;AAEA,e;AACA,8C;AACA,wB;AACA,U;AACA,oC;;AAEA,mC;AACA,mC;;AAEA,oB;;AAEA,wB;AACA,sB;;AAEA,G;;AAEA,wC;AACA,kC;AACA,uD;;AAEA,qC;AACA,mD;AACA,8C;;;AAGA,mC;AACA,yC;AACA,uC;AACA,2B;AACA,iF;AACA,uD;AACA,8C;AACA,kC;AACA,4C;AACA,kB;AACA,0E;AACA,2C;AACA,U;AACA,kE;AACA,gD;AACA,G;;AAEA,I;AACA,0C;AACA,4E;AACA,+C;AACA,I;;AAEA,0C;AACA,I;AACA,0C;AACA,4E;AACA,2B;AACA,I;AACA,mF;;AAEA,oC;AACA,2C;AACA,2F;AACA,e;AACA,iC;AACA,U;AACA,oE;AACA,yC;AACA,G;AACA,C;;AAEA,E;AACA,+D;AACA,uE;AACA,E;AACA,qE;AACA,kE;AACA,+D;AACA,yC;AACA,E;AACA,qE;AACA,iE;AACA,G;AACA,4B;AACA,4B;AACA,8B;AACA,oF;;AAEA,qB;AACA,iD;AACA,gD;;AAEA,mB;AACA,+C;AACA,wC;;AAEA,oB;AACA,sB;AACA,sB;AACA,gC;AACA,oB;AACA,G;AACA,C;;AAEA,gE;;AAEA,gC;AACA,2C;AACA,gD;AACA,yB;AACA,wC;AACA,0C;AACA,gC;;AAEA,qB;AACA,kB;AACA,2B;AACA,4B;AACA,oC;AACA,oC;AACA,6D;AACA,iE;AACA,6C;AACA,O;AACA,K;;AAEA,M;AACA,mB;AACA,O;AACA,oE;AACA,mE;AACA,M;AACA,O;;AAEA,iD;;AAEA,4C;AACA,4B;AACA,wB;AACA,qC;AACA,qE;AACA,kC;AACA,8C;AACA,8E;AACA,qE;AACA,6C;AACA,2C;AACA,S;AACA,O;;AAEA,O;;AAEA,wB;AACA,iC;AACA,gB;AACA,G;AACA,E;;AAEA,iD;AACA,yC;AACA,6C;;;;;;;;;;;;;;;;;;;ACvXA,wD;AACA,6B;AACA,gC;AACA,qC;AACA,wB;;AAEA,uD;AACA,0C;AACA,gC;AACA,mC;AACA,0B;;AAEA,6D;AACA,mC;AACA,Q;AACA,2C;AACA,sC;AACA,yD;AACA,4C;AACA,a;;AAEA,Y;AACA,mF;AACA,8E;AACA,a;AACA,+E;;AAEA,0C;AACA,4C;AACA,4C;;AAEA,iD;AACA,uD;;AAEA,wD;AACA,yD;;AAEA,yD;AACA,4E;AACA,W;AACA,Q;AACA,6C;AACA,sC;AACA,yC;AACA,mD;AACA,iD;;AAEA,sC;;AAEA,2E;AACA,mD;AACA,gC;;AAEA,sC;AACA,iC;;AAEA,uE;AACA,wD;AACA,qD;AACA,sD;AACA,wB;AACA,oB;AACA,c;AACA,a;AACA,Y;;AAEA,uD;AACA,2E;AACA,kB;AACA,uC;AACA,Y;;AAEA,qE;AACA,qE;AACA,W;;AAEA,uE;AACA,oC;;AAEA,iB;;AAEA,0D;AACA,qC;AACA,qC;;AAEA,U;;AAEA,kE;AACA,+D;AACA,kC;AACA,W;AACA,Q;AACA,yD;AACA,sC;AACA,+C;AACA,W;AACA,Q;AACA,uD;AACA,sC;AACA,sD;AACA,4C;;AAEA,kD;AACA,4C;AACA,W;AACA,O;AACA,O;AACA,C;;AAEA,8B;AACA,4B;AACA,mC;;AAEA,4B;AACA,+D;AACA,sE;;AAEA,2D;AACA,yB;AACA,sD;;AAEA,2D;AACA,kD;;AAEA,2B;AACA,6B;AACA,sC;;AAEA,oD;AACA,qC;AACA,4E;AACA,sC;AACA,O;AACA,C;;AAEA,gC;AACA,4B;AACA,8B;;AAEA,wC;;AAEA,2B;AACA,gC;;AAEA,+C;AACA,oC;AACA,C;;AAEA,gE;;AAEA,oC;AACA,+C;AACA,gD;AACA,0D;AACA,yB;AACA,gB;AACA,G;AACA,E;;AAEA,yD;AACA,iD;AACA,qD;;AAEA,E;AACA,wD;AACA,iD;AACA,gB;AACA,K;;AAEA,iC;AACA,yD;AACA,kC;AACA,qC;AACA,4B;;;AAGA,K;;AAEA,kB;AACA,C;AACA,+C;AACA,E;;;;;;;;;;;;;;;;;;ACrLA,qB;;AAEA,iC;AACA,8C;AACA,C;;AAEA,4D;AACA,6B;AACA,qC;AACA,gC;AACA,c;AACA,wC;AACA,M;AACA,C;;AAEA,+B;;AAEA,2D;;AAEA,4C;AACA,+B;AACA,oC;AACA,sC;AACA,mB;AACA,K;AACA,K;;AAEA,2C;AACA,+B;AACA,oC;AACA,qC;AACA,mB;AACA,K;AACA,K;;AAEA,iD;AACA,qC;AACA,4B;;AAEA,iC;AACA,8D;AACA,G;AACA,gC;AACA,6B;AACA,G;AACA,2E;;AAEA,iE;AACA,mB;AACA,oE;AACA,gF;AACA,gB;;AAEA,qD;;AAEA,yB;AACA,8C;AACA,oD;AACA,gB;;AAEA,mC;AACA,sD;AACA,kE;AACA,yC;AACA,oD;AACA,a;AACA,gB;;AAEA,gD;AACA,sD;AACA,kE;AACA,yC;AACA,0D;AACA,a;AACA,gB;;AAEA,uD;AACA,yE;AACA,wD;AACA,kE;AACA,yC;AACA,sD;AACA,a;AACA,gB;AACA,a;AACA,K;;AAEA,K;;;AAGA,G;;AAEA,E;AACA,+D;AACA,6B;AACA,8B;AACA,mC;AACA,kB;AACA,6B;AACA,0B;AACA,K;AACA,E;;AAEA,kE;AACA,kD;AACA,E;AACA,E;;;;;;;;;;;;;;;;;;AC1GA,iB;;AAEA,oE;AACA,8D;AACA,0D;AACA,uB;AACA,S;;AAEA,I;AACA,sC;AACA,kC;AACA,mB;AACA,I;;AAEA,+B;AACA,iE;AACA,8B;AACA,kC;AACA,kC;;AAEA,kB;AACA,+D;AACA,C;;AAEA,qE;AACA,2D;AACA,iC;AACA,kB;AACA,wB;AACA,mC;AACA,oD;AACA,wB;AACA,0E;AACA,8B;AACA,0E;AACA,8B;AACA,M;AACA,wE;AACA,6D;AACA,C;;;;;;;;;;;;;;;;;;;ACvCA,+B;AACA,uE;AACA,8C;AACA,G;;;;;;;;;;;;;;;;;;;ACHA,+B;AACA,2E;;AAEA,6C;AACA,8B;AACA,M;;AAEA,iE;AACA,yB;AACA,iD;AACA,2B;AACA,2C;AACA,G;;AAEA,I;AACA,G;;;;;;;;;;;;;;;;;;;ACfA,+B;AACA,8D;AACA,6C;AACA,kB;AACA,qB;;AAEA,wB;AACA,yC;AACA,kC;;AAEA,gC;;AAEA,mB;AACA,iD;AACA,0B;AACA,iC;AACA,M;AACA,G;AACA,I;AACA,G;;;;;;;;;;;;;;;;;;;ACnBA,+B;AACA,sD;AACA,6C;AACA,qC;AACA,0D;AACA,gE;;AAEA,yB;AACA,oC;AACA,O;AACA,mC;AACA,G;AACA,I;AACA,G;;;;;;;;;;;;;;;;;;;ACbA,+B;AACA,4E;AACA,6C;AACA,qC;AACA,e;AACA,+F;AACA,sC;AACA,G;AACA,I;AACA,G;;;;;;;;;;;;;;;;;;;ACTA,qB;AACA,W;AACA,0C;AACA,gC;AACA,M;AACA,yC;AACA,gC;AACA,K;AACA,G;AACA,e;AACA,0C;AACA,yF;AACA,M;AACA,yC;AACA,6E;AACA,K;AACA,G;AACA,O;AACA,0C;AACA,iD;AACA,M;AACA,yC;AACA,2D;AACA,K;AACA,E;AACA,E;;AAEA,0E;AACA,kE;AACA,sC;AACA,oE;AACA,mE;AACA,E;;AAEA,+B;AACA,wE;AACA,6C;AACA,kB;AACA,qB;;AAEA,wB;AACA,yC;AACA,kC;;AAEA,6C;AACA,oB;AACA,6C;AACA,e;AACA,sB;AACA,gC;AACA,Y;AACA,mD;AACA,K;AACA,I;;AAEA,gC;;AAEA,mB;AACA,iD;AACA,0B;AACA,iC;AACA,M;AACA,I;;AAEA,+D;AACA,6B;AACA,wC;AACA,e;AACA,sB;AACA,gC;AACA,Y;AACA,mD;AACA,S;AACA,I;AACA,G;AACA,I;AACA,G;;;;;;;;;;;;;;;;;;;AC5EA,+B;AACA,4D;AACA,iC;AACA,mD;AACA,kD;AACA,oB;AACA,G;AACA,I;AACA,G;;;;;;;;;;;;;;;;;;;ACRA,+B;AACA,qD;;AAEA,iE;AACA,kB;AACA,kB;AACA,2C;AACA,sE;AACA,kD;AACA,kD;AACA,W;AACA,mC;AACA,a;AACA,M;AACA,K;;AAEA,I;AACA,G","sourcesContent":["var mainCtx = null;\n\n// Could use something from --settings too\nvar isDev = (\"localhost\" === window.location.hostname);\n\nlog = new Logger('famous-views');\nLogger.setLevel('famous-views', isDev ? 'trace' : 'info');\n\nFView = famousCmp = {};\n\nvar readyQueue = [];\nvar readyDep = new Deps.Dependency;\nFView.ready = function(func) {\n\tif (func) {\n    if (FView.isReady)\n      func();\n    else  \n\t\t  readyQueue.push(func);\n  } else {\n\t\treadyDep.depend();\n\t\treturn FView.isReady;\n\t}\n}\nFView.runReadies = function() {\n\tFView.isReady = true;\n\treadyDep.changed();\n\twhile(readyQueue.length) {\n\t\t(readyQueue.shift())();\n\t}\n}\n\n// famous-views globals from Famous\nTransform = null;\n\nif (typeof(famous) === 'undefined' && typeof(define) !== 'undefined')\ndefine(function(require) {\n//  console.log(1);\n});\n\nFView.startup = function() {\n  log.debug('Current logging default is \"debug\" (for localhost).  '\n    + 'Change in your app with Logger.setLevel(\"famous-views\", \"info\");');\n  FView.startedUp = true;\n\n  famous.polyfills;\n  famous.core.famous;\n  Transform = famous.core.Transform;\n\n  // Note, various views are registered here\n  FView.runReadies();\n\n  // Required document.body\n  Meteor.startup(function() {\n\n    // Sanity check, disallow templates with same name as a View\n    var names = [];\n    for (var name in FView.views)\n      if (Template[name])\n        names.push(name);\n    if (names.length)\n      throw new Error(\"You have created Template(s) with the same name \"\n        + \"as these famous-views: \" + names.join(', ')\n        + '.  Nothing will work until you rename them.');\n\n    if (FView.mainCtx)\n      mainCtx = FView.mainCtx;\n    else {\n      if (FView.mainCtx !== false)\n        log.debug('Creating a new main context.  If you already have '\n          + 'your own, set FView.mainCtx = yourMainContext (or to false to get '\n          + 'rid of this warning)');\n      FView.mainCtx = mainCtx = famous.core.Engine.createContext();\n    }\n\n    if (Template.famousInit)\n      Blaze.render(Template.famousInit, document.body);\n  });\n};\n\nFView.isReady = false;\n\n// Imports from weak deps\n/*\nif (Package['mjnetworks:famous'])\n  // @famono ignore\n  famous = Package['mjnetworks:famous'].famous;\nelse if (Package['mjnetworks:mj-famous'])\n  // @famono ignore\n  famous = Package['mjnetworks:mj-famous'].famous;\n*/\n\n// Load as ealry as possible, and keep trying\nif (typeof(famous) !== 'undefined') {\n  log.debug(\"Starting up.  famous global found while loading package, great!\");\n  FView.startup();\n}\nelse\n  Meteor.startup(function() {\n    if (typeof(famous) !== 'undefined') {\n      log.debug(\"Starting up.  famous global found during Meteor.startup()\");\n    \tFView.startup();\n    } else {\n      log.debug(\"No famous global available in Meteor.startup().  Call FView.startup() when appropriate.\");\n    }\n  });\n\noptionString = function(string) {\n  if (string == 'undefined')\n    return undefined;\n  if (string == 'true')\n    return true;\n  if (string == 'false')\n    return false;  \n  if (string === null)\n    return null;\n\n  if (string[0] == '[' || string[0] == '{') {\n    var obj;\n    string = string.replace(/\\bauto\\b/g, '\"auto\"');\n    string = string.replace(/undefined/g, '\"__undefined__\"');\n    // JSON can't parse values like \".5\" so convert them to \"0.5\"\n    string = string.replace(/([\\[\\{,]+)(\\W*)(\\.[0-9])/g, '$1$20$3');\n\n    try {\n      obj = JSON.parse(string);\n    }\n    catch (err) {\n      log.error(\"Couldn't parse JSON, skipping: \" + string);\n      log.error(err);\n      return undefined;\n    }\n\n    for (var key in obj)\n      if (obj[key] === '__undefined__')\n        obj[key] = undefined;\n    return obj;\n  } else {\n    var float = parseFloat(string);\n    if (!_.isNaN(float))\n      return float;\n    return string;\n  }\n\n  /*\n  if (string == 'undefined')\n    return undefined;\n  if (string == 'true')\n    return true;\n  if (string == 'false')\n    return false;\n  if (string.substr(0,1) == '[') {\n    var out = [];\n    string = string.substr(1, string.length-2).split(',');\n    for (var i=0; i < string.length; i++)\n      out.push(optionString(string[i].trim()));\n    return out;\n  }\n  if (string.match(/^[0-9\\.]+$/))\n    return parseFloat(string);\n  */\n}\n\nhandleOptions = function(data) {\n  options = {};\n  for (var key in data) {\n    var value = data[key];\n    if (_.isString(value))\n      options[key] = optionString(value);\n    else\n      options[key] = value;\n  }\n  return options;\n}\n\n/* --- totally not done --- */\n\nFView.showTreeGet = function(renderNode) {\n  var obj = renderNode._node._child._object;\n    if (obj.node)\n      obj.node = this.showTreeGet(obj.node);\n  return obj;\n}\nFView.showTreeChildren = function(renderNode) {\n  var out = {}, i=0;\n  if (renderNode._node)\n    out['child'+(i++)] = this.showTreeGet(renderNode)\n  return out;\n}\nFView.showTree = function() {\n  console.log(this.showTreeChildren(mainCtx));\n}\n\n/* --- */\n\n\n","/*\n * Templates are always added to a MeteorFamousView (\"fview\"), in turn is\n * added to it's parent fview or a context.  This allows us to handle\n * situations where a template is later removed (since nodes cannot ever\n * be manually removed from the render tree).\n * \n * http://stackoverflow.com/questions/23087980/how-to-remove-nodes-from-the-ren\n */\n\nvar meteorFamousViews = {};\nvar meteorFamousViewsCount = 0;\n\nMeteorFamousView = function(blazeView, options, noAdd) {\n  this.id = options.id || ++meteorFamousViewsCount;\n  meteorFamousViews[this.id] = this;\n\n  this.blazeView = blazeView;\n  this.children = [];\n  if (noAdd)\n    return;\n  \n  var parent = blazeView;\n  while ((parent=parent.parentView) && !parent.fview);\n  parent = parent ? parent.fview : { node: FView.mainCtx };\n\n  this.parent = parent;\n\n  /*\n  if (options) {\n    if (options.size) {\n      this.size = options.size;\n    }\n  }\n  */\n\n  if (parent.children) // i.e. not main context\n    parent.children.push(this);\n\n  if (parent._view && parent._view.add)\n  \t// views can explicitly handle how their children should be added\n  \tparent._view.add.call(parent, this, options);\n  else if (parent.sequencer)\n  \t// if the node has a sequencer, add by pushing to the sequence array\n    parent.sequencer.sequence.push(this);\n  else if (!parent.node || (parent.node._object && parent.node._object.isDestroyed))\n    // compView->compView.  long part above is temp hack for template rerender #2010\n    parent.setNode(this);\n  else\n  \t// default case, just use the add method\n    parent.node.add(this);\n}\n\nMeteorFamousView.prototype.render = function() {\n  if (this.isDestroyed)\n    return [];\n  if (this.node)\n    return this.node.render();\n  console.log('render called before anything set');\n  return [];\n}\n\nMeteorFamousView.prototype.setNode = function(node) {\n  // surface or modifier/view\n  this.node = new famous.core.RenderNode(node);\n  return this.node;\n}\n\nMeteorFamousView.prototype.preventDestroy = function() {\n\tthis.destroyPrevented = true;\t\n}\n\nMeteorFamousView.prototype.destroy = function() {\n  //log.debug('Destroyed ' + this._view.name + ' (#' + this.id + ')');\n\n  if (this.parent && this.parent.sequencePurge)\n    this.parent.sequencePurge();\n\n  this.isDestroyed = true;\n  this.node = null;\n  this.view = null;\n  this.modifier = null;\n  delete(meteorFamousViews[this.id]);\n}\n\nMeteorFamousView.prototype.sequencePurge = function() {\n  if (!this.sequencer)\n    return;\n\n  var sequence = this.sequencer.sequence,\n    length = sequence.length;\n\n  for (var i=0; i < length; i++)\n    if (sequence[i].isDestroyed) {\n      sequence.splice(i--, 1);\n      length--;\n    }\n}\n\nMeteorFamousView.prototype.getSize = function() {\n  return this.node && this.node.getSize() || this.size || [true,true];\n}\n\nthrowError = function(startStr, object) {\n  if (object instanceof Object)\n    console.error(object);\n  throw new Error('FView.getData() expects BlazeView or TemplateInstance or '\n      + 'DOM node, but got ' + object);\n}\n\nFView.from = function(viewOrTplorEl) {\n  if (viewOrTplorEl instanceof Blaze.View)\n    return FView.fromBlazeView(viewOrTplorEl);\n  else if (viewOrTplorEl instanceof Blaze.TemplateInstance)\n    return FView.fromTemplate(viewOrTplorEl);\n  else if (viewOrTplorEl && typeof viewOrTplorEl.nodeType === 'number')\n    return FView.fromElement(viewOrTplorEl);\n  else {\n    throwError('FView.getData() expects BlazeView or TemplateInstance or '\n        + 'DOM node, but got ', viewOrTplorEl);\n  }\n}\n\nFView.fromBlazeView = FView.dataFromView = function(view) {\n  while ((view=view.parentView) && !view.fview);\n  return view ? view.fview : undefined;  \n}\n\nFView.fromTemplate = FView.dataFromTemplate = function(tplInstance) {\n  return this.dataFromView(tplInstance.view);\n}\n\nFView.fromElement = FView.dataFromElement = function(el) {\n  var view = Blaze.getView(el);\n  return this.dataFromView(view);\n}\n\nFView.byId = function(id) {\n  return meteorFamousViews[id];\n}\n\n// Leave as alias?  Deprecate?\nFView.dataFromCmp = FView.dataFromComponent;\nFView.dataFromTpl = FView.dataFromTemplate;\n\nFView.dataFromComponent = function(component) {\n  log.warn(\"FView.dataFromComponent has been deprecated.  Please use 'FView.fromBlazeView' instead.\");\n  return FView.fromBlazeView(component);\n}\n","/* Sequencer and childSequence */\n\nsequencer = function() {\n  this.sequence = [];\n  this.children = [];\n}\n\nsequencer.prototype.child = function() {\n  var child = new childSequence(this);\n  this.children.push(child);\n  return child;\n}\n\nfunction childSequence(parent, childNo, startIndex) {\n    this.parent = parent;\n    this.childNo = parent.children.length;\n    this.startIndex = parent.sequence.length;\n    this.sequence = [];\n}\n\nchildSequence.prototype.push = function(value) {\n  this.parent.sequence.splice(this.startIndex+this.sequence.length-1, 0, value);\n  for (var i=this.childNo+1; i < this.parent.children.length; i++) {\n    this.parent.children[i].startIndex++;\n  }\n  return this.sequence.push(value);\n}\n\nchildSequence.prototype.splice = function(index, howMany /*, arguments */) {\n  var diff, max = this.sequence.length - index;\n  if (howMany > max) howMany = max;\n  diff = (arguments.length - 2) - howMany; // inserts - howMany\n\n  for (var i=this.childNo+1; i < this.parent.children.length; i++)\n    this.parent.children[i].startIndex += diff;\n\n  this.sequence.splice.apply(this.sequence, arguments);\n  arguments[0] += this.startIndex;  // add startIndex and re-use args  \n  return this.parent.sequence.splice.apply(this.parent.sequence, arguments);\n}","/* Extend Meteor Template framework for .famousEvents() */\nTemplate.prototype.famousEvents = function (eventMap) {\n  var template = this;\n  template.__famousEventMaps = (template.__famousEventMaps || []);\n  template.__famousEventMaps.push(eventMap);\n};\n\nfunction setupEvents(fview, template) {\n  if (template.__famousEventMaps) {\n    _.each(template.__famousEventMaps, function(eventMap) {\n      for (var k in eventMap) {\n        var target = fview.surface || fview.view._eventInput;\n        target.on(k, function() {\n          eventMap[k].call(null, {type:k}, fview);\n        });\n      }\n    });\n  }\n}\n\nfunction autoHeight(fview, div) {\n  var height = div.scrollHeight;\n  if (height && (!fview.size || (fview.size.length == 2 && fview.size[1] != height))) {\n    fview.size = [undefined, height];\n    if (fview.modifier) {\n      fview.modifier.setSize(fview.size);\n      fview.surface.setSize([undefined,undefined]);\n    } else {\n      fview.surface.setSize(fview.size);\n    }\n  } else {\n    Meteor.setTimeout(function() {\n      autoHeight(fview, div);\n    }, 10);\n  }\n}\n\nfunction templateSurface(div, fview, renderedTemplate, tName, options) {\n  // var div = document.createElement('div');\n  var autoSize = options.size && options.size[1] == 'auto';\n\n  if (autoSize)\n    options.size = [0, 0];\n  else\n    div.style.height='100%';\n  div.style.width='100%';\n\n  /*\n  if (fview.uiHooks)\n    div._uihooks = fview.uiHooks;\n  */\n\n//  UI.insert(renderedTemplate, div);\n\n//  we're now forced to always render in main func\n//  renderedTemplate.domrange.attach(div);\n\n  if (!options)\n    options = {};\n\n  // If any HTML was generated, create a surface for it\n  if (options.view=='Surface' || div.innerHTML.trim().length) {\n    var surfaceOptions = { classes: [ 't_'+tName.replace(/ /, '_') ] };\n    if (options.classes)\n      surfaceOptions.classes = _.union(surfaceOptions.classes,\n        _.isArray(options.classes) ? options.classes : options.classes.split(','));\n    if (options.class)\n      surfaceOptions.classes = _.union(surfaceOptions.classes,\n        _.isArray(options.class) ? options.class : options.class.split(' '));\n\n    surfaceOptions.content = div;\n    surfaceOptions.size = fview.size;\n\n    fview.surface = fview.view;\n    fview.surface.setOptions(surfaceOptions);\n\n    /*\n    fview.surface = new famous.core.Surface(surfaceOptions);\n    if (!fview.node)\n      // nothing, i.e. Surface & no modifier\n      fview.setNode(fview.surface);\n    else if (!fview.sequencer)\n      // add Surface as only child\n      fview.node.add(fview.surface);\n    else {\n      fview.sequencer.sequence.push(fview.surface);\n    }\n    */\n\n    var pipeChildrenTo = fview.parent.pipeChildrenTo;\n    if (pipeChildrenTo)\n      for (var i=0; i < pipeChildrenTo.length; i++)\n        fview.surface.pipe(pipeChildrenTo[i]);\n\n    if (autoSize)\n      autoHeight(fview, div);\n  }  \n}\n\n// Used by famousEach too\nparentViewName = function(blazeView) {\n  while (blazeView.name == \"with\" || blazeView.name == \"(contentBlock)\")\n    blazeView = blazeView.parentView;\n  return blazeView.name;\n}\nparentTemplateName = function(blazeView) {\n  while (blazeView && !blazeView.name.match(/^Template/))\n    blazeView = blazeView.parentView;\n  return blazeView.name;\n}\n\n// Need to fire manually at appropriate time,\n// for non-Surfaces which are never added to the DOM by meteor\nrunRenderedCallback = function(view) {\n//  if (view._callbacks.rendered && view._callbacks.rendered.length)\n  var needsRenderedCallback = true; // uh yeah, TODO :>\n  view.domrange = null; // TODO, check if it's a surface / real domrange\n  if (needsRenderedCallback && ! view.isDestroyed &&\n      view._callbacks.rendered && view._callbacks.rendered.length) {\n    Deps.afterFlush(function callRendered() {\n      if (needsRenderedCallback && ! view.isDestroyed) {\n        needsRenderedCallback = false;\n        Blaze._fireCallbacks(view, 'rendered');\n      }\n    });\n  }\n}\n\nfunction famousCreated() {\n  var blazeView = this.view;\n  var famousViewName = blazeView.name ? blazeView.name.substr(7) : \"\";\n\n  this.data = this.data || {};\n  var dataContext = this.data.data\n    || Blaze._parentData(1) && Blaze._parentData(1, true)\n    || Blaze._parentData(0) && Blaze._parentData(0, true)\n    || {};\n\n  // deprecate\n  if (!this.data.view && famousViewName === \"\")\n    this.data.view = 'SequentialLayout';\n  if (!this.data.view) this.data.view = famousViewName;\n  else if (!famousViewName) {\n    famousViewName = this.data.view;\n    blazeView.viewName = 'Famous.' + famousViewName;\n  }\n\n  // Deprecated 2014-08-17\n  if (this.data.size && _.isString(this.data.size) && this.data.size.substr(0,1) != '[')\n    throw new Error('[famous-views] size=\"' + this.data.size + '\" is deprecated, please use '\n      + 'size=\"['+ this.data.size + ']\" instead');\n\n  // See attribute parsing notes in README\n  var options = handleOptions(this.data);\n\n  // These require special handling (but should still be moved elsewhere)\n  if (this.data.direction)\n    options.direction = this.data.direction == \"Y\"\n      ? famous.utilities.Utility.Direction.Y\n      : famous.utilities.Utility.Direction.X;\n  if (options.translate) {\n    options.transform =\n      Transform.translate.apply(null, options.translate);\n    delete options.translate;\n  }\n  // any other transforms added here later must act on existing transform matrix\n\n  if (!this.data.modifier && (this.data.origin || this.data.size || this.data.translate || this.data.transform))\n    this.data.modifier = 'StateModifier';\n\n  var fview = blazeView.fview = new MeteorFamousView(blazeView, options);\n  fview._view = FView.views[this.data.view] || { name: this.data.view };\n\n  var pViewName = parentViewName(blazeView.parentView);\n  var pTplName = parentTemplateName(blazeView.parentView);\n  log.debug('New ' + famousViewName + \" (#\" + fview.id + ')'\n    + (this.data.template\n      ? ', content from \"' + this.data.template + '\"'\n      : ', content from inline block')\n    + ' (parent: ' + pViewName\n    + (pViewName == pTplName\n      ? ''\n      : ', template: ' + pTplName)\n    + ')');\n\n  /*\n  if (FView.viewOptions[this.data.view]\n      && FView.viewOptions[this.data.view].childUiHooks) {\n    // if childUiHooks specified, store them here too\n    fview.childUiHooks = FView.viewOptions[this.data.view].childUiHooks;\n  } else if (fview.parent.childUiHooks) {\n    if (this.data.view == 'Surface') {\n      fview.uiHooks = fview.parent.childUiHooks;\n    } else {\n      // Track descedents\n    }\n    console.log('child ' + this.data.view);\n  }\n  */\n\n  var view, node;\n\n  if (this.data.view /* != 'Surface' */) {\n\n    view = FView.getView(this.data.view);\n    node = new view(options);\n\n    if (node.sequenceFrom) {\n      fview.sequencer = new sequencer();\n      node.sequenceFrom(fview.sequencer.sequence);\n    }\n\n  }\n\n  if (this.data.modifier) {\n\n    fview._modifier = FView.modifiers[this.data.modifier];\n    fview.modifier = fview._modifier.create.call(fview, options);\n\n    if (node) {\n      fview.setNode(fview.modifier).add(node);\n      fview.view = node;\n    } else\n      fview.setNode(fview.modifier);\n\n    if (fview._modifier.postRender)\n      fview._modifier.postRender();\n\n  } else if (node) {\n\n    fview.setNode(node);\n    fview.view = node;\n\n  }\n\n  // could do pipe=1 in template helper?\n  if (fview.parent.pipeChildrenTo)\n    fview.pipeChildrenTo = fview.parent.pipeChildrenTo;\n\n  // think about what else this needs\n  if (fview._view && fview._view.famousCreatedPost)\n    fview._view.famousCreatedPost.call(fview);\n\n\n  // Render contents (and children)\n  var newBlazeView, template, scopedView;\n  if (blazeView.templateContentBlock) {\n    if (this.data.template)\n      throw new Error(\"A block helper {{#View}} cannot also specify template=X\");\n    // Called like {{#famous}}inlineContents{{/famous}}\n    template = blazeView.templateContentBlock;\n  } else if (this.data.template) {\n    template = Template[this.data.template];\n    if (!template)\n      throw new Error('Famous called with template=\"' + this.data.template\n        + '\" but no such template exists');\n  } else {\n    // Called with inclusion operator but not template {{>famous}}\n    throw new Error(\"No template='' specified\");\n  }\n\n  /*\n  newBlazeView = template.constructView();\n  scopedView = Blaze.With(dataContext, function() { return newBlazeView; });\n  Blaze.materializeView(scopedView, blazeView);\n  */\n\n  var div = document.createElement('div');\n  /*\n  newBlazeView = Blaze.render(function() {\n    Blaze.With(dataContext, function() { return template.constructView(); })\n  }, div, null, blazeView);\n  */\n  newBlazeView = Blaze.renderWithData(template, dataContext, div, null, blazeView);\n\n  if (this.data.view == 'Surface') {\n    templateSurface(div, fview, scopedView,\n      this.data.template || parentTemplateName(blazeView.parentView).substr(9) + '_inline',\n      options);\n    setupEvents(fview, template);\n  } else {\n    // no longer necessary since we're forced to render to a div now\n    // runRenderedCallback(newBlazeView);\n  }\n}\n\n/*\n * This is called by Blaze when the View/Template is destroyed,\n * e.g. {{#if 0}}{{#Scrollview}}{{/if}}.  When this happens we need to:\n *\n * 1) Destroy children (Blaze won't do it since it's not in the DOM),\n *    and any \"eaches\" that may have been added from a famousEach.\n * 2) Call fview.destroy() which handles cleanup w.r.t. famous,\n *    which lives in meteorFamousView.js.\n *\n * It's possible we want to have the \"template\" destroyed but not the\n * fview in the render tree to do a graceful exit animation, etc.\n */\nfunction famousDestroyed() {\n  var blazeView = this.view;\n  var fview = blazeView.fview;\n  log.debug('Destroying ' + fview._view.name + ' (#' + fview.id + ') and children');\n\n  if (fview.children)\n    for (var i=0; i < fview.children.length; i++)\n      Blaze.remove(fview.children[i].blazeView);\n\n  if (fview.eaches)\n    for (var i=0; i < fview.eaches.length; i++)\n      Blaze.remove(fview.eaches[i]);    \n\n  // XXX ADD TO DOCS\n  if (fview.onDestroy)\n    fview.onDestroy();\n  if (!fview.destroyPrevented) {\n    fview.destroy();\n  }\n}\n\n// Keep this at the bottom; Firefox doesn't do function hoisting\n\nFView.famousView = new Template(\n  'famous',           // viewName: \"famous\"\n  function() {        // Blaze.View \"renderFunc\"\n    var blazeView = this;\n    var data = Blaze.getData(blazeView);\n    var tpl = blazeView._templateInstance;\n    var fview = blazeView.fview;\n\n    var changed = {};\n    var orig = {};\n    for (var key in data) {\n      var value = data[key];\n      if (typeof value === \"string\")\n        value = optionString(value);\n      if (value != tpl.data[key] || !blazeView.hasRendered) {\n        orig[key] = blazeView.hasRendered ? tpl.data[key] : null;\n        changed[key] = tpl.data[key] = value;\n      }\n    }\n\n    /*\n     * Think about:\n     * \n     * 1) Should the function get the old value or all old data too?\n     * 2) Should the function get all the new data, but translated?\n     *\n     */\n\n    _.each(['modifier', 'view'], function(node) {\n\n      // If the fview has a modifier or view\n      var what = '_' + node;\n      if (fview[what]) {\n        if (fview[what].attrUpdate) {\n          // If that mod/view wants to finely handle reactive updates\n          for (var key in changed)\n            fview[what].attrUpdate.call(fview,\n              key, changed[key], orig[key], tpl.data, !blazeView.hasRendered);\n        } else if (fview[node].setOptions && blazeView.hasRendered) {\n          // Otherwise if it has a setOptions\n          fview[node].setOptions(tpl.data);\n        }\n      }\n\n    });\n\n//    console.log(view);\n    blazeView.hasRendered = true;\n    return null;\n  }\n);\n\nBlaze.registerHelper('famous', FView.famousView);\nFView.famousView.created = famousCreated;\nFView.famousView.destroyed = famousDestroyed;\n","function famousEachRender(eachView, template, argFunc) {\n  var fview = eachView.fview;\n  var sequence = fview.sequence;\n  var children = fview.children = [];\n  var size = fview.size;\n\n  // For Blaze.currentView (see blaze/builtins.js#each)\n  eachView.argVar = new Blaze.ReactiveVar;\n  eachView.autorun(function () {\n    eachView.argVar.set(argFunc());\n  }, eachView.parentView);\n\n  eachView.stopHandle = ObserveSequence.observe(function () {\n      return eachView.argVar.get();\n    }, {\n      addedAt: function (id, item, index) {\n        Deps.nonreactive(function () {\n          var newItemView = Blaze.With(item, function() {\n            return template.constructView();\n          });\n\n          /*\n           * This is the repeated block inside famousEach, but not the actual node/\n           * view/surface that gets created on render as this block's children\n           */\n          newItemView.fview = new MeteorFamousView(null, {}, true /* noAdd */);\n\n          if (fview.parent.pipeChildrenTo)\n            newItemView.fview.pipeChildrenTo\n              = fview.parent.pipeChildrenTo;\n\n          children.splice(index, 0, newItemView);\n          sequence.splice(index, 0, newItemView.fview);\n\n          var unusedDiv = document.createElement('div');\n          Blaze.render(newItemView, unusedDiv, eachView);\n\n          //Blaze.materializeView(newItemView, eachView);\n          //runRenderedCallback(newItemView);  // now called by Blaze.render\n        });\n      },\n      removedAt: function (id, item, index) {\n        Deps.nonreactive(function () {\n        \tvar blazeView = children[index];\n        \t// XXX see when/why this got so convoluted\n        \tvar fview = blazeView.fview.children[0];\n\n        \tif (fview.destroyPrevented) {\n\n        \t\t// Keep a reference to this exact child, since index might change\n        \t\tvar thisChild = sequence.sequence[index];\n        \t\tvar origIndex = index;\n\n        \t\tfview.destroy = function() {\n        \t\t\tvar index = origIndex;\n\n        \t\t\t// If we're not in the original position, find our new index\n        \t\t\tif (sequence.sequence[index] !== thisChild) {\n        \t\t\t\tfor (var i=0; i < children.length; i++) {\n        \t\t\t\t\tif (sequence.sequence[i] === thisChild) {\n        \t\t\t\t\t\tindex = i;\n        \t\t\t\t\t\tbreak;\n        \t\t\t\t\t}\n        \t\t\t\t}\n        \t\t\t}\n\n      \t\t\t\tif (sequence.sequence[index] !== thisChild) {\n      \t\t\t\t\tlog.error(\"Could not find original child in index!\", thisChild);\n      \t\t\t\t} else {\n\t\t\t          sequence.splice(index, 1);\n\t\t\t        }\n\n\t\t          // Call the original destroy() method that this overrides\n        \t\t\tMeteorFamousView.prototype.destroy.apply(this, arguments);\n        \t\t}\n\n        \t\t// Blaze children/indexes must always be in sync with observe\n\t\t        children.splice(index, 1);\n\n        \t} else {\n\n        \t\t// If !destroyPrevented, just remove immediately\n\t          children.splice(index, 1);\n\t          sequence.splice(index, 1);\n\n        \t}\n\n        \t// Destroys the blaze template/view.  Calls .onDestroy(),\n        \t// and also .destroy() if .preventDestroy() not called\n          Blaze.remove(blazeView);\n        });\n      },\n      changedAt: function (id, newItem, oldItem, index) {\n        Deps.nonreactive(function () {\n          children[index].dataVar.set(newItem);\n        });\n      },\n      movedTo: function (id, doc, fromIndex, toIndex) {\n        Deps.nonreactive(function () {\n          var item = sequence.splice(fromIndex, 1)[0];\n          sequence.splice(toIndex, 0, item);\n\n          item = children.splice(fromIndex, 1)[0];\n          children.splice(toIndex, 0, item);\n        });\n      }\n    });\n}\n\nfunction famousEachCreated() {\n  var blazeView = this.view;\n  var fview = blazeView.fview = {};\n\n  log.debug('New famousEach'\n    + ' (parent: ' + parentViewName(blazeView.parentView) + ','\n    + ' template: ' + parentTemplateName(blazeView.parentView) + ')');\n\n  // famousEach specific: don't create new MeteorFamousView\n  var parent = blazeView;\n  while ((parent=parent.parentView) && !parent.fview);\n\n  fview.parent = parent ? parent.fview : { node: mainCtx };\n  fview.sequence = fview.parent.sequencer.child();\n\n  if (!parent.fview.eaches)\n    parent.fview.eaches = [];\n  parent.fview.eaches.push(blazeView);\n\n  // Contents of {{#famousEach}}block{{/famousEach}}\n  if (blazeView.templateContentBlock)\n    famousEachRender(blazeView, blazeView.templateContentBlock, function() {\n      return Blaze.getData(blazeView);\n    });\n}\n\nfunction famousEachDestroyed() {\n  var blazeView = this.view;\n  var fview = blazeView.fview;\n\n  log.debug('Destroying FamousEach...');\n\n  if (blazeView.stopHandle)\n    blazeView.stopHandle.stop();\n\n  for (var i=0; i < fview.children.length; i++)\n    Blaze.remove(fview.children[i]);\n}\n\n// Keep this at the bottom; Firefox doesn't do function hoisting\n\nFView.famousEachView = new Template(\n  'famousEach',       // viewName: \"famousEach\"\n  function() {        // Blaze.View \"renderFunc\"\n    var view = this;  // Blaze.View, viewName \"famousEach\"\n    // console.log(view);\n    return null;\n  }\n);\n\nBlaze.registerHelper('famousEach', FView.famousEachView);\nFView.famousEachView.created = famousEachCreated;\nFView.famousEachView.destroyed = famousEachDestroyed;\n\n/*\nFView.Each = function (argFunc, contentFunc, elseFunc) {\n  var eachView = Blaze.View('Feach', function() {\n    return null;\n  });\n\n  eachView.onCreated(function() {\n    // For Blaze.currentView (see blaze/builtins.js#each)\n    eachView.autorun(function () {\n      eachView.argVar.set(argFunc());\n    }, eachView.parentView);\n\n\n  });\n\n  return eachView;\n}\nBlaze.registerHelper('famousEach', FView.Each);\n*/","FView.modifiers = {};\n\nfunction defaultCreate(options) {\n  return new this._modifier.modifier(options);\n}\n\nFView.registerModifier = function(name, modifier, options) {\n  if (!FView.modifiers[name])\n    FView.modifiers[name] = _.extend(\n      { create: defaultCreate },\n      options,\n      { name: name, modifier: modifier }\n    );\n}\n\nFView.ready(function(require) {\n\n  FView.registerModifier('modifier', famous.core.Modifier);\n\n  FView.registerModifier('identity', null, {\n    create: function(options) {\n      return new Modifier(_.extend({\n        transform : Transform.identity\n      }, options));\n    }\n  });\n\n  FView.registerModifier('inFront', null, {\n    create: function(options) {\n      return new Modifier(_.extend({\n        transform : Transform.inFront\n      }, options));\n    }\n  });\n\n  function modifierMethod(fview, method, value) {\n    if (fview.modifierTransitionHalt)\n      fview.modifier.halt();\n\n    fview.modifier[method](value,\n      fview.modifierTransition, fview.modifierTransitionDone);\n  }\n  function degreesToRadians(x) {\n    return x * Math.PI / 180;\n  }\n  FView.registerModifier('StateModifier', famous.modifiers.StateModifier, {\n\n    attrUpdate: function(key, value, oldValue, data, firstTime) {\n      switch(key) {\n        case 'transform': case 'opacity': case 'align': case 'size':\n          modifierMethod(this, 'set'+key[0].toUpperCase()+key.substr(1), value);\n          break;\n\n        // Below are helpful shortcuts for transforms\n\n        case 'translate':\n          modifierMethod(this, 'setTransform',\n            Transform.translate.apply(null, value));\n          break;\n\n        case 'skewX': case 'skewY':\n          var skewBy = (value || 0) - (oldValue || 0);\n          modifierMethod(this, 'setTransform', Transform.multiply(\n            this.modifier.getTransform(),\n            Transform[key](degreesToRadians(skewBy))\n          ));\n          break;\n\n        case 'skewZ': // doesn't exist in famous\n          var skewBy = (value || 0) - (oldValue || 0);\n          modifierMethod(this, 'setTransform', Transform.multiply(\n            this.modifier.getTransform(),\n            Transform.skew(0, 0, degreesToRadians(skewBy))\n          ));\n          break;\n\n        case 'rotateX': case 'rotateY': case 'rotateZ':\n          // value might be undefined from Session with no SessionDefault\n          var rotateBy = (value || 0) - (oldValue || 0);\n          modifierMethod(this, 'setTransform', Transform.multiply(\n            this.modifier.getTransform(),\n            Transform[key](degreesToRadians(rotateBy))\n          ));\n          break;\n      }      \n    }\n\n  });\n\n\n});\n\n/*\nFView.modifiers.pageTransition = function(blazeView, options) {\n  this.blazeView = blazeView;\n  this.famous = new Modifier({\n    transform : Transform.identity,\n    opacity   : 1,\n    origin    : [-0.5, -0.5],\n    size      : [100, 100]\n  });\n};\n\nFView.modifiers.pageTransition.prototype.postRender = function() {\n  this.famous.setOrigin([0,0], {duration : 5000});\n};\n*/","FView.views = {};\n\n/* Available in JS via `FView.views.Scrollview` and in templates via\n\t`{{#famous view='Scrollview'}}` or just `{{#Scrollview}}`. */\nFView.registerView = function(name, famousView, options) {\n\tif (FView.views[name])\n\t\treturn;\n\n  /*\n  var tpl = _.clone(FView.famousView);\n  tpl.viewName = 'Famous.' + name;\n  console.log(tpl);\n  */\n\n  var fview = FView.famousView;\n  var tpl = new Template('Famous.' + name, fview.renderFunction);\n  tpl.created = fview.created;\n  tpl.destroyed = fview.destroyed;\n  Blaze.registerHelper(name, tpl);\n\n\tFView.views[name]\n\t\t= _.extend(options || {}, { name: name, class: famousView });\n}\n\n/* Do we still need this?  Most people explicitly register views with\n   registerView() these days, to get the template helper */\nFView.getView = function(name)  {\n\t// @famono silent\n  if (FView.views[name])\n    return FView.views[name].class;\n  if (typeof Famous !== 'undefined' && Famous[name])\n    return Famous[name];\n  if (typeof Famous !== 'undefined' && famous.Views && Famous.Views[name])\n    return Famous.Views[name];\n  if (typeof famous !== 'undefined' && famous.views && famous.views[name])\n    return famous.views[name];\n  else\n    throw new Error('Wanted view \"' + name + '\" but it doesn\\'t exists.'\n      + ' Try FView.registerView(\"'+name+'\", require(...))');\n}\n","FView.ready(function(require) {\n\tFView.registerView('SequentialLayout', famous.views.SequentialLayout);\n\tFView.registerView('View', famous.core.View);\n});\n","FView.ready(function(require) {\n\tFView.registerView('ContainerSurface', famous.surfaces.ContainerSurface, {\n\n\t\tadd: function(child_fview, child_options) {\n\t\t\tthis.view.add(child_fview);\n    },\n\n    attrUpdate: function(key, value, oldValue, data, firstTime) {\n\t\t\tif (key == 'overflow')\n\t\t\t\tthis.view.setProperties({ overflow: value });\n\t\t\telse if (key == 'class')\n\t\t\t\tthis.view.setClasses(value.split(\" \"));\n\t\t}\n\n\t});\n});\n","FView.ready(function(require) {\n\tFView.registerView('EdgeSwapper', famous.views.EdgeSwapper, {\n\t\tadd: function(child_fview, child_options) {\n\t\t\tif (!this.view)\n\t\t\t\treturn;  // when?\n\n\t\t\tif (this.currentShow)\n\t\t\t\tthis.previousShow = this.currentShow;\n\t\t\tthis.currentShow = child_fview;\n\n\t\t\tchild_fview.preventDestroy();\n\n\t\t\tvar self = this;\n\t\t\tthis.view.show(child_fview, null, function() {\n\t\t\t\tif (self.previousShow)\n\t\t\t\t\tself.previousShow.destroy();\n\t\t\t});\n\t\t}\n\t});\n});\n","FView.ready(function(require) {\n\tFView.registerView('Flipper', famous.views.Flipper, {\n\t\tadd: function(child_fview, child_options) {\n\t\t\tvar target = child_options.target;\n\t\t\tif (!target || (target != 'back' && target != 'front'))\n\t\t\t\tthrow new Error('Flipper must specify target=\"back/front\"');\n\n\t\t\tif (target == 'front')\n\t\t\t\tthis.view.setFront(child_fview);\n\t\t\telse\n\t\t\t\tthis.view.setBack(child_fview);\n\t\t}\n\t});\n});\n","FView.ready(function(require) {\n\tFView.registerView('HeaderFooterLayout', famous.views.HeaderFooterLayout, {\n\t\tadd: function(child_fview, child_options) {\n\t\t\tvar target = child_options.target;\n\t\t\tif (!target)\n\t\t\t\tthrow new Error('HeaderFooterLayout children must specify target=\"header/footer/content\"');\n\t\t\tthis.view[target].add(child_fview);\n\t\t}\n\t});\n});\n","FView.transitions = {\n\topacity: {\n    outTransformFrom: function(progress) {\n      return Transform.Identity;\n    },\n    inTransformFrom: function(progress) {\n      return Transform.Identity;\n    }\n\t},\n\tslideWindow: {\n    outTransformFrom: function(progress) {\n      return Transform.translate(window.innerWidth * progress - window.innerWidth, 0, 0);\n    },\n    inTransformFrom: function(progress) {\n      return Transform.translate(window.innerWidth * (1.0 - progress), 0, 0);\n    }\n\t},\n\tWIP: {\n    outTransformFrom: function(progress) {\n      return Transform.rotateY(Math.PI*progress);\n    },\n    inTransformFrom: function(progress) {\n      return Transform.rotateY(Math.PI + Math.PI*progress);\n    }\n\t}\n};\n\n// Other option is to allow a slideDirection attribute.  Think about this.\nFView.transitions.slideWindowLeft = FView.transitions.slideWindow;\nFView.transitions.slideWindowRight = {\n    outTransformFrom: FView.transitions.slideWindow.inTransformFrom,\n    inTransformFrom: FView.transitions.slideWindow.outTransformFrom\n};\n\nFView.ready(function(require) {\n\tFView.registerView('RenderController', famous.views.RenderController, {\n\t\tadd: function(child_fview, child_options) {\n\t\t\tif (!this.view)\n\t\t\t\treturn;  // when?\n\n\t\t\tif (this.currentShow)\n\t\t\t\tthis.previousShow = this.currentShow;\n\t\t\tthis.currentShow = child_fview;\n\n\t\t\tvar transition = child_options.transition;\n\t\t\tif (transition) {\n\t\t\t\tvar data = FView.transitions[transition];\n\t\t\t\tif (data) {\n\t\t\t\t\tfor (key in data)\n\t\t\t\t\t\tthis.view[key](data[key]);\n\t\t\t\t} else {\n\t\t\t\t\tlog.error('No such transition ' + transition);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tchild_fview.preventDestroy();\n\n\t\t\tvar self = this;\n\t\t\tthis.view.show(child_fview, null, function() {\n\t\t\t\tif (self.previousShow)\n\t\t\t\t\tself.previousShow.destroy();\n\t\t\t});\n\t\t},\n\n\t\tattrUpdate: function(key, value, oldValue, data, firstTime) {\n\t\t\tif (key == 'transition') {\n\t\t\t\tvar data = FView.transitions[value];\n\t\t\t\tif (data) {\n\t\t\t\t\tfor (key in data)\n\t\t\t\t\t\tthis.view[key](data[key]);\n\t\t\t\t} else {\n\t\t\t\t\tlog.error('No such transition ' + transition);\n\t\t\t\t}\t\t\t\t\n\t\t\t}\n\t\t}\n\t});\n});\n","FView.ready(function(require) {\n\tFView.registerView('Scrollview', famous.views.Scrollview, {\n\t\tfamousCreatedPost: function() {\n\t\t\tthis.pipeChildrenTo = this.parent.pipeChildrenTo\n\t\t\t\t? [ this.view, this.parent.pipeChildrenTo[0] ]\n\t\t\t\t: [ this.view ];\n\t\t}\n\t});\n});\n","FView.ready(function(require) {\n\tFView.registerView('Surface', famous.core.Surface, {\n\n    attrUpdate: function(key, value, oldValue, data, firstTime) {\n    \tswitch(key) {\n    \t\tcase 'size':\n    \t\t\t// Let our modifier control our size\n    \t\t\t// Long term, rather specify modifierSize and surfaceSize args?\n    \t\t\tif (this._modifier.name == 'StateModifier')\n\t\t\t\t\t\tthis.surface.setSize([undefined,undefined]);\n    \t\t\telse\n  \t\t\t\t\tthis.surface.setSize(value);\n    \t\t\tbreak;\n    \t}\n    }\n\n\t});\n});\n"]}